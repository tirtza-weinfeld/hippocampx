# Subagents

## Resizable Table of Contents

## What Are Subagents?

Subagents are **isolated specialists**. They run in a separate context (subprocess), complete a task, and return results. Their instructions don't persist in your main conversation.

**Isolated context heaps**: Each subagent has its own context window. They don't get confused by each other's context, and they don't pollute your main conversation.

## File Location

| Location | Scope |
|----------|-------|
| `.claude/agents/*.md` | Project-specific |
| `~/.claude/agents/*.md` | All projects |

## File Format

```markdown
---
name: react-19-reviewer
description: Reviews React code for modern patterns. Use after writing components.
tools: Read, Grep, Glob
model: inherit
---

You review React components for React 19.2+ best practices.

## Check For

- No forwardRef (refs are props now)
- No useCallback/useMemo (compiler handles it)
- Server components by default
- useActionState for forms
- use() for data fetching

## Output Format

For each file:
1. Issues found (with line numbers)
2. How to fix
3. Modern pattern example
```

## Frontmatter Options

| Field | Required | Default | Description |
|-------|----------|---------|-------------|
| `name` | Yes | — | Lowercase with hyphens |
| `description` | Yes | — | When to invoke this agent |
| `tools` | No | All | Comma-separated tool list |
| `model` | No | sonnet | `sonnet`, `opus`, `haiku`, `inherit`, or `dynamic` |
| `skills` | No | — | Skills to auto-load |
| `permissionMode` | No | default | `default`, `acceptEdits`, `bypassPermissions` |

**Dynamic model selection**: Use `model: dynamic` to let Claude choose the best model for the task (Haiku for simple searches, Opus for complex reasoning).

## Invoking Subagents

**Automatic** — Claude delegates based on description:
```
> Review my React components for modern patterns
```

**Explicit** — Request by name:
```
> Use the react-19-reviewer agent to check Dashboard.tsx
```

**CLI** — Interactive management:
```
/agents
```

## Tool Access

Limit tools to what the subagent needs:

```yaml
tools: Read, Grep, Glob  # Read-only reviewer
```

```yaml
tools: Read, Edit, Bash  # Can modify code
```

Omit `tools` to inherit all tools from main conversation.

## Using Skills in Subagents

Subagents can auto-load skills:

```yaml
---
name: react-developer
description: Writes React components
tools: Read, Edit, Write
skills: react-19
---
```

## Examples

### Code Reviewer

```markdown
---
name: code-reviewer
description: Reviews code for quality and security. Use after writing code.
tools: Read, Grep, Glob, Bash
---

You are a senior code reviewer.

## Review Checklist

- Clear, readable code
- No duplicated logic
- Proper error handling
- No exposed secrets
- Input validation at boundaries

## Output

Organize by priority:
- Critical (must fix)
- Warning (should fix)
- Suggestion (consider)
```

### Debugger

```markdown
---
name: debugger
description: Investigates errors and test failures.
tools: Read, Edit, Bash, Grep, Glob
---

You are an expert debugger.

## Process

1. Capture error message and stack trace
2. Identify reproduction steps
3. Isolate failure location
4. Implement minimal fix
5. Verify solution

## Output

- Root cause explanation
- Evidence
- Code fix
- Prevention recommendation
```

### Test Runner

```markdown
---
name: test-runner
description: Runs tests and fixes failures.
tools: Bash, Read, Edit, Grep
---

Run tests after code changes. If tests fail:
1. Analyze failure
2. Fix while preserving test intent
3. Verify no regressions
```

## Built-in Subagents

Claude Code includes built-in subagents:

| Name | Model | Purpose |
|------|-------|---------|
| `Explore` | Haiku | Fast codebase searching |
| `Plan` | — | Implementation planning |

These are automatically available without configuration.

## Best Practices

1. **Single responsibility** — One clear purpose per subagent
2. **Limit tools** — Only grant what's needed
3. **Include examples** — Show expected output format
4. **Use PROACTIVELY** in description — Encourages automatic delegation
5. **Version control** — Commit project subagents for team use
