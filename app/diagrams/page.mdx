# ERDiagram Syntax Design

## Proposed: SQL-like, FK auto-infers relationships

```erDiagram
--- LEXICAL CORE ---

lexical_entries
  id             int           PK
  lemma          varchar(255)
  part_of_speech partofspeech
  language_code  varchar(5)
  discriminator  int
  embedding      halfvec(1536)
  metadata       jsonb
  created_at     timestamp
  updated_at     timestamp

word_forms
  id                    int     PK
  entry_id              int     FK(lexical_entries.id)
  form_text             varchar(255)
  grammatical_features  jsonb

senses
  id                  int     PK
  entry_id            int     FK(lexical_entries.id)
  definition          text
  order_index         int
  embedding           halfvec(1536)
  is_synthetic        boolean
  verification_status varchar(50)

entry_audio
  id           int     PK
  entry_id     int     FK(lexical_entries.id)
  audio_url    varchar(512)
  transcript   text
  duration_ms  int
  accent_code  varchar(10)
  content_type varchar(50)

--- TAXONOMY & TAGS ---

categories
  id              varchar(50)   PK
  display_name    varchar(100)
  ai_description  text

tags
  id          int           PK
  category_id varchar(50)   FK(categories.id)
  name        varchar(100)
  metadata    jsonb

sense_tags
  sense_id    int   PK FK(senses.id)
  tag_id      int   PK FK(tags.id)
  explanation text

--- KNOWLEDGE GRAPH & RELATIONS ---

sense_relations
  id              int           PK
  source_sense_id int           FK(senses.id)
  target_sense_id int           FK(senses.id)
  relation_type   relationtype
  strength        int
  explanation     text

--- SOURCES & HIERARCHY ---

examples
  id              int     PK
  sense_id        int     FK(senses.id)
  text            text
  language_code   varchar(5)
  source_part_id  int     FK(source_parts.id)
  embedding       halfvec(1536)
  cached_citation varchar(255)

contributors
  id        int     PK
  name      varchar(255)
  type      varchar(50)
  metadata  jsonb

sources
  id                int     PK
  type              sourcetype
  title             varchar(255)
  publication_year  int
  reliability_score real
  metadata          jsonb

source_credits
  source_id       int         PK FK(sources.id)
  contributor_id  int         PK FK(contributors.id)
  role            creditrole  PK

source_parts
  id              int     PK
  source_id       int     FK(sources.id)
  parent_part_id  int     FK(source_parts.id)
  name            varchar(255)
  type            varchar(50)
  order_index     int
```

## Syntax Rules

**Domains:** `--- DOMAIN NAME ---` groups tables visually
**Tables:** Name on its own line, columns indented below
**Columns:** `name type [constraints]`
**Constraints:**
  - `PK` = primary key
  - `FK(table.column)` = foreign key (auto-draws relationship)
  - `UK` = unique
  - Multiple: `PK FK(table.id)` (space-separated)

**Relationships:** Auto-inferred from FK definitions - no separate syntax needed!

## Comparison

| Feature | Mermaid | Proposed |
|---------|---------|----------|
| Column order | `int id` | `id int` (SQL-like) |
| FK target | Separate line | `FK(table.column)` inline |
| Relationships | `\|\|--o{` manually | Auto from FK |
| Self-reference | Confusing | `FK(same_table.id)` |
| Composite PK | `PK,FK` | `PK FK(table)` |
| Domains | Not supported | `--- NAME ---` sections |



                      ┌─────────────┐
   line to PK ───────◁│ column      │
                      └─────────────┘

                      ┌─────────────┐
                      │ column      │▷───────── line to PK
                      └─────────────┘
  
                
                      