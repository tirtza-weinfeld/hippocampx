```python meta="source=problems/416-partition-equal-subset-sum/solution.py"
def canPartition(nums: list[int]) -> bool:

    if (total := sum(nums)) & 1:
        return False

    nums.sort(reverse=True)
    if nums[0] > (target := total // 2):
        return False

    memo = {}

    def dp(i: int, r: int) -> bool:
        if r == 0:
            return True
        if r < 0 or i == len(nums):
            return False
        if (k := (i, r)) not in memo:
            memo[k] = dp(i + 1, r - nums[i]) or dp(i + 1, r)
        return memo[k]

    return dp(0, target)
```