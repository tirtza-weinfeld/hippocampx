```python meta="source=problems/2402-meeting-rooms-iii/solution.py"
from heapq import heappush, heappop, heapify

def mostBooked(n: int, meetings: list[list[int]]) -> int:

    busy = []
    heapify((free := [*range(n)]))
    count = [0] * n

    for s, e in sorted(meetings):
        while busy and busy[0][0] <= s:
            _, r = heappop(busy)
            heappush(free, r)
        if free:
            r = heappop(free)
            heappush(busy, (e, r))
        else:
            next_end, r = heappop(busy)
            heappush(busy, (next_end + (e - s), r))
        count[r] += 1

    return max(range(n), key=count.__getitem__)
```