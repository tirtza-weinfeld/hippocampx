```python meta="source=problems/212-word-search-ii/solution.py"
def word_search_II(board: list[list[str]], words: list[str]) -> list[str]:
    trie = {}  
    for word in words:
        node = trie
        for c in word:
            node = node.setdefault(c, {})
        node["$"] = word

    def dfs(i, j, parent):
        if not (0 <= i < m and 0 <= j < n) or (c := board[i][j]) not in parent:
            return
        node = parent[c]
        if "$" in node:
            res.append(node.pop("$"))
        board[i][j] = "#"
        for x, y in ((i - 1, j), (i + 1, j), (i, j - 1), (i, j + 1)):
            dfs(x, y, node)
        board[i][j] = c
        if not node:
            parent.pop(c)
            
    m, n, res = len(board), len(board[0]), []
    [dfs(i, j, trie) for i in range(m) for j in range(n) if board[i][j] in trie]

    return res
```