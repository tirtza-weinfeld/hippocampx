```python meta="source=problems/909-snakes-and-ladders/solution.py"
from collections import deque

def snakes_and_ladders(board: list[list[int]]) -> int:

    flat_board =  [0] # Dummy 0 for 1-based indexing
    for r, row in enumerate(reversed(board)):
        flat_board.extend(row[::1 if r % 2 == 0 else -1])
        
    target =(n:= len(board)) * n 
    moves, queue =  {1: 0}, deque([1])

    while queue:
        current = queue.popleft()
        for roll in range(1, 7):
            nxt = current + roll
            if nxt > target:
                break
            landing = flat_board[nxt] if flat_board[nxt] != -1 else nxt
            if landing not in moves:
                moves[landing] = moves[current] + 1
                if landing == target:
                    return moves[landing]
                queue.append(landing)
    return -1
```