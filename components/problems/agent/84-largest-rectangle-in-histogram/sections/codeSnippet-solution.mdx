```python meta="source=problems/84-largest-rectangle-in-histogram/solution.py"
def largestRectangleArea(heights: list[int]) -> int:
    heights.append(0)
    stack = [-1]; best = 0
    for r, h in enumerate(heights):
        while stack[-1] != -1 and heights[stack[-1]] > h:
            l = stack.pop()
            best = max(best, heights[l] * (r - stack[-1] - 1))
        stack.append(r)
    heights.pop()
    return best
```