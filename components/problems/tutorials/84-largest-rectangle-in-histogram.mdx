# Largest Rectangle in Histogram

## Resizable Table Of contents

<DifficultyBadge difficulty="hard" />

<PillList pills={["stack"]} />

[84. Largest Rectangle in Histogram](https://leetcode.com/problems/largest-rectangle-in-histogram)

## [!(ProblemDefinition)] Definition

Given an array of integers representing the histogram's bar heights where the width of each bar is 1,     return the area of the largest rectangle in the histogram.

## [!(ProblemIntuition)] Intuition

- Each bar can form a rectangle where its height is the limiting factor:
    - That rectangle extends until a strictly shorter bar appears on either side.
    - Instead of searching both directions explicitly, we discover these bounds on the fly:
        - when a shorter bar appears at `r`, every taller bar popped from the stack
        - now knows its right boundary (`r`) and its left boundary (`l = stack.pop()`).

- Deep Dive: Walkthrough:
    - Append `0` so every bar eventually meets a shorter right neighbor
    - Keep *[3!]indices* in strictly increasing heights (stack starts *[3!][-1]*)
    - For each `r, h`: while top is taller, pop `l` and compute area = `heights[l] * (r - stack[-1] - 1)`
    - Push `r`; remove the sentinel; return best

## [!(ProblemTimeComplexity)] Time Complexity

- $O(n)$:
    - Each index is pushed once and popped once, so the total operations across the loop are linear
    - *[19!]It remains linear despite the inner while, because every pop is matched to one push*

## [!(ProblemKeyVariables)] Key Variables

- `stack`: indices with strictly increasing heights

## [!(ProblemCodeSnippet)] Code Snippet

```python meta="source=problems/84-largest-rectangle-in-histogram/solution.py"
def largestRectangleArea(heights: list[int]) -> int:
    heights.append(0)
    stack = [-1]; best = 0
    for r, h in enumerate(heights):
        while stack[-1] != -1 and heights[stack[-1]] > h:
            l = stack.pop()
            best = max(best, heights[l] * (r - stack[-1] - 1))
        stack.append(r)
    heights.pop()
    return best
```

