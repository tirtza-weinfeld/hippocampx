# LFU Cache

## Resizable Table Of contents

<DifficultyBadge difficulty="hard" />

<PillList pills={["cache"]} />

[460. LFU Cache](https://leetcode.com/problems/lfu-cache)

## [!(ProblemDefinition)] Definition

A cache that evicts the least frequently used item when the cache is full.

## [!(ProblemCodeSnippet)] Code Snippet

```python meta="source=problems/460-lfu-cache/solution.py"
from collections import defaultdict, OrderedDict

class LFUCache:
    def __init__(self, capacity: int):
        self.capacity    = capacity
        self.cache       = {}
        self.freq        = {}
        self.buckets     = defaultdict(OrderedDict)
        self.minfreq     = 0

    def _bump(self, key: int):
        f = self.freq[key]
        del self.buckets[f][key]
        if not self.buckets[f]:
            del self.buckets[f]
            if self.minfreq == f:
                self.minfreq += 1

        self.freq[key] +=1
        self.buckets[f + 1][key] = None

    def get(self, key: int) -> int:
        if key not in self.cache:
            return -1
        self._bump(key)
        return self.cache[key]

    def put(self, key: int, value: int) -> None:
        if self.capacity <= 0:
            return

        if key in self.cache:
            self.cache[key] = value
            self._bump(key)
            return

        if len(self.cache) >= self.capacity:
            old_key, _ = self.buckets[self.minfreq].popitem(last=False)
            del self.cache[old_key]
            del self.freq[old_key]

        self.cache[key] = value
        self.freq[key] = 1
        self.buckets[1][key] = None
        self.minfreq = 1
```

