# New 21 Game

## Resizable Table Of contents

<DifficultyBadge difficulty="medium" />

<PillList pills={["game"]} />

[837. New 21 Game](https://leetcode.com/problems/new-21-game/)

## [!(ProblemDefinition)] Definition

You start at 0. Keep adding a random number from 1…n while your total < k.
    Find P(final total ≤ maxPts).

## [!(ProblemIntuition)] Intuition

- `dp[i]` is the probability that the game **ends** with total score `i`:
    - To end at score `i` in one draw, you must have been at some score `j` that:
        - was **still active** (`j < k`, so drawing is allowed), and
        - was **close enough to reach i** in a single draw (`i - maxPts ≤ j ≤ i - 1`).
    - All such `j` values form a sliding window behind `i`.
    - The variable `s` keeps the **sum of dp[j] over exactly those valid j**.
    - Since every draw 1..maxPts is equally likely, the transition is: *$dp[i] = \frac{s}{\text{maxPts}}$*
    - And the answer is the total probability of all **terminal scores** *$i \ge k$* that are also ≤ n.

## [!(ProblemTimeComplexity)] Time Complexity

- $O(n + maxPts)$:
    - Each index enters and leaves the sliding window once

## [!(ProblemReturns)] Returns

`float`: The total probability that the final stopped score is ≤ n (i.e., sum over i ≥ k).

## [!(ProblemCodeSnippet)] Code Snippet

```python meta="source=problems/837-new-21-game/solution.py"
def new21Game(n: int, k: int, maxPts: int) -> float:

    if k == 0 or n >= k + maxPts:
        return 1.0

    dp = [0] * (n + 1)
    dp[0] = s = 1

    for i in range(1, n + 1):
        dp[i] = s / maxPts
        if i < k:
            s += dp[i]
        if i - maxPts >= 0 and i - maxPts < k:
            s -= dp[i - maxPts]
    return sum(dp[k:])
```

