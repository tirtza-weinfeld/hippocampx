---
description: testing
alwaysApply: false
---
# Test

Vitest + Testing Library + Playwright | pytest + pytest-asyncio

## Files

`*.test.tsx` `*.test.ts` `*.spec.ts` `test_*.py`

## Component

```tsx
test('click', async () => {
  const user = userEvent.setup()
  const fn = vi.fn()
  render(<Button onClick={fn}>Save</Button>)
  await user.click(screen.getByRole('button', { name: /save/i }))
  expect(fn).toHaveBeenCalledOnce()
})
```

## Async

```tsx
test('load', async () => {
  render(<List />)
  await waitFor(() => expect(screen.getByText('Item')).toBeInTheDocument())
})
```

## Mock

```tsx
vi.mock('next/navigation', () => ({
  useRouter: () => ({ push: vi.fn() }),
}))
```

## Python

```python
@pytest.mark.asyncio
async def test_api():
    async with AsyncClient(app=app) as c:
        r = await c.get("/api/data")
        assert r.status_code == 200
```

## E2E

```ts
test('nav', async ({ page }) => {
  await page.goto('/')
  await page.getByRole('link', { name: 'Dashboard' }).click()
  await expect(page).toHaveURL('/dashboard')
})
```